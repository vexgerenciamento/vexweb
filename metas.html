<html lang="en">
    <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#000000">
    <meta name="description" content="Web site created using create-react-app">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.sandbox.google.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
        
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="stylesheet" href="https://fonts.sandbox.google.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
  <link rel="stylesheet" href="https://fonts.sandbox.google.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" />
  <link rel="stylesheet" href="https://fonts.sandbox.google.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" />
  <link rel="stylesheet" href="https://fonts.sandbox.google.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" />
  <link rel="stylesheet" href="https://fonts.sandbox.google.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" />
  <link rel="stylesheet" href="https://fonts.sandbox.google.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />



    <style>
        .sumiu{
            display: none;
        }
    </style>



    <script src="autenticar.js"></script>
    <script src="logout.js"></script>
    <!--
      manifest.json provides metadata used when your web app is installed on a
      user's mobile device or desktop. See https://developers.google.com/web/fundamentals/web-app-manifest/
    -->
    <link rel="manifest" href="/manifest.json">
    <link rel="stylesheet" href="CSS/meta.css">
    <!--
      Notice the use of  in the tags above.
      It will be replaced with the URL of the `public` folder during the build.
      Only files inside the `public` folder can be referenced from the HTML.

      Unlike "/favicon.ico" or "favicon.ico", "/favicon.ico" will
      work correctly both with client-side routing and a non-CORPO public URL.
      Learn how to configure a non-CORPO public URL by running `npm run build`.
    -->
    <title>VEX GERENCIAMENTO</title>

  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  

</head>
<body id="body">
<div class="modal" id="modalDeletar">
            <div class="modal-content">
                <header class="modal-header">
                    <h2>DESEJA REALMENTE EXCLUIR?</h2>
                    <span class="modal-close" id="modalCloseExcluir">&#10006;</span>
                </header>
            
                <footer class="modal-footer">
                    <button id="excluir" class="button blue">EXCLUIR</button>
                </footer>
            </div>
        </div>
    <div>
        <div class="corpo" style="margin-bottom: -90px;">

            
            
            <div class="inner body" style="min-width: 500px;">




                <nav id="nav">
                    <img id="icon" src="img/vex dourado.png" width="40px" height="40px" ><p id="icontext">Suas Metas</p><span class="material-symbols-rounded" id="closing">close</span>
            
                    <span class="material-symbols-rounded" id="opening">menu</span>
            
                    <br>
                    <br>
                    <br>
                    <br>


                    <ul id="links">
                        <div id="metas"><a href="metas.html" id="line1"><li><span class="material-symbols-outlined" style="position:relative; left: -40px; top: 5px; transform: rotate(1deg);">add_task</span>Metas</li></a></div>
                        <div id="graph"><a href="graphicos.html" id="line2"><li><span class="material-symbols-outlined" style="position:relative; left: -40px; top: 5px; transform: rotate(1deg);">touch_app</span>Gráficos</li></a></div>
                        <div id="control"><a href="controle.html" id="line3"><li><span class="material-symbols-outlined" style="position:relative; left: -40px; top: 5px; transform: rotate(1deg);">monitoring</span>Controle</li></a></div>
                    </ul>
                    <p id="between">______________________________________________</p>
                    <br>
                    <br>
                    

                <button id="logoff" onclick="logout();" style="background-color: transparent; border:none;"><span class="material-symbols-outlined" id="iclogout">logout</span><p id="sairir" style="display: inline-table; text-align: center;">Sair</p></button></div><br><br>
                </nav>



                
                

            </div>
            
            <div class="sc-hKgJUU frdCTY" id="counteuld">
                <div class="sc-jrAFXE eqoOME" style="flex-direction: column; flex-wrap: wrap; align-content: stretch; justify-content: space-evenly; align-items: stretch;">
                    <div class="sc-kEjbQP fuVdYh">
                        <div class="sc-iqHYmW jklSBJ setleft" id="anterior"><span class="material-symbols-outlined unselectable">
                            arrow_forward_ios
                            </span></div>
                        <div class="sc-crrszt cPfwyB" id="mes">Abril de 2022</div>
                        <div class="sc-iqHYmW jklSBJ setright" id="proximo"><span class="material-symbols-outlined unselectable">
                            arrow_back_ios
                            </span></div>
                    </div>
                    <div class="sc-dQoVA klQxRK">
                        <div class="sc-bqyKOL fXEhmA">
                            <div class="sc-kstqJO bQkMyN">Ganhos</div>
                            <div class="sc-hBEYId hZHyLH" id="ganhoInicial">R$00</div>
                        </div>
                        <div class="sc-bqyKOL fXEhmA">
                            <div class="sc-kstqJO bQkMyN">Despesas</div>
                            <div class="sc-hBEYId hZHyLH" style="color:rgb(255, 0, 0);" id="despesaInicial">R$00 </div>
                        </div>
                        <div class="sc-bqyKOL fXEhmA">
                            <div class="sc-kstqJO bQkMyN">Balanço</div>
                            <div color="green" class="sc-hBEYId ftQMvP" id="balanco">R$00 </div>
                        </div>
                    </div>
                </div>
                <div class="sc-fodVek fgloXw">
                    <label class="sc-fFucqa hmyJIQ">
                        <div class="sc-bkzYnD kLxSip">Titulo</div>
                        <input type="text" class="sc-idOiZg rwnMw" value=""  id="titulo">
                    </label>
                    <label class="sc-fFucqa hmyJIQ">
                        <div class="sc-bkzYnD kLxSip">Categoria</div>
                        <select class="sc-dIUeWJ gesRgG" id="categoria">
                            <option>

                            </option>
                            <option value="Alimentação">Alimentação</option>
                            <option value="Entretenimento">Entretenimento</option>
                            <option value="Habitação">Habitação</option>
                            <option value="Salário">Salário</option>
                            <option value="Saúde">Saúde</option>
                            <option value="Seguros">Seguros</option>
                            <option value="Transportes">Transportes</option>                
                            <option value="Outros">Outros</option>
                            
                        </select>
                    </label>
                    
                    <label class="sc-fFucqa hmyJIQ">
                        <div class="sc-bkzYnD kLxSip">Período</div>
                        <select class="sc-idOiZg rwnMw" id="periodo" required>
                            <option>

                            </option>
                            <option value="Mensal">Mensal</option>
                            <option value="Bimestral">Bimestral</option>                           
                        </select>
                    </label>                 
                        <label class="sc-fFucqa hmyJIQ">
                            <div class="sc-bkzYnD kLxSip">Valor</div>
                            <input type="number" class="sc-idOiZg rwnMw" value="" id="valor"></label>
                            <label class="sc-fFucqa hmyJIQ">
                                <div class="sc-bkzYnD kLxSip">&nbsp;</div>
                                <button class="sc-hHfuMS dcAQVR" id="adicionar">Adicionar</button>
                                <button class="sc-hHfuMS dcAQVR sumiu" id="editar">Editar</button>
                            </label>
                        </div>
                        <table class="sc-eCstlR bkasyz">
                                <thead>
                                    <tr>
                                        <th class="sc-jSgvzq fouaSj alignTitulo">Título</th>
                                        <th width="130" class="sc-jSgvzq fcmwIe alignCategoria">Categoria</th>
                                        <th width="100" class="sc-jSgvzq gyieuF alignData">Periodo</th>
                                        <th width="150" class="sc-jSgvzq jaAmsI alignValor">Valor</th>
                                        <th width="130" style="color: white; text-align: start; position: relative; left: 16px;">Ações</th>
                                    </tr>
                                </thead>

                                <tbody id="tbody">
                                    
                                </tbody>
                                    </table>
                                </div>
                            </div>
                            <div id="IdVerdadeiro"></div>
                            <div id="guardaOmes" style="color: white; display: none;"></div>
                        </div>











                        <script>

                            var counteuld = document.getElementById("counteuld");

                            function myFunction(x) {
                              if (x.matches) { // If media query matches
                                document.body.style.backgroundColor = "202020";
                                nav.style.zIndex = "1";
                                nav.style.left = "-300px";
                                nav.style.backgroundColor = "transparent";
                                closing.style.opacity = "0";
                                opening.style.position = "relative";
                                opening.style.opacity = "100";
                                opening.style.marginRight = "-220px";
                                opening.style.bottom = "40px";
                                closing.style.display = "none";                            

                                opening.addEventListener("click", function(){
                                    nav.style.left = "-0px";
                                    nav.style.backgroundColor = "2b2b2b";
                                    nav.style.transition = "1s";
                                    closing.style.opacity = "100";
                                    closing.style.position = "relative";
                                    counteuld.style.filter = "blur(1px)";
                                    closing.style.display = "flex";
                                    closing.style.marginLeft = "110px";
                                });

                                closing.addEventListener("click", function(){
                                    nav.style.left = "-300px";
                                    nav.style.backgroundColor = "transparent";
                                    nav.style.transition = "1s";
                                    closing.style.opacity = "0";
                                    opening.style.opacity = "100";
                                    opening.style.marginRight = "-150px";
                                    opening.style.position = "relative";
                                    counteuld.style.filter = "blur(0px)";
                                    opening.style.display = "inline-table";
                                closing.style.display = "inline-table";
                                });                               

                              } else {
                               document.body.style.backgroundColor = "202020";
                              }
                            }
                            
                            var x = window.matchMedia("(max-width: 414px)")
                            myFunction(x) // chama o listener na hora
                            x.addListener(myFunction) // seta a função em relação as mudanças


                            









                            var counteuld = document.getElementById("counteuld");

                            function myFunction(y) {
                              if (y.matches) { // If media query matches
                                document.body.style.backgroundColor = "202020";
                                nav.style.zIndex = "1";
                                nav.style.left = "-300px";
                                nav.style.backgroundColor = "transparent";
                                closing.style.opacity = "0";
                                opening.style.position = "relative";
                                opening.style.opacity = "100";
                                opening.style.marginRight = "-250px";
                                opening.style.bottom = "40px";
                                closing.style.display = "none";    
                                                      

                                opening.addEventListener("click", function(){
                                    nav.style.left = "-0px";
                                    nav.style.backgroundColor = "2b2b2b";
                                    nav.style.transition = "1s";
                                    closing.style.opacity = "100";
                                    closing.style.position = "relative";
                                    counteuld.style.filter = "blur(1px)";
                                    closing.style.display = "flex";
                                    closing.style.marginLeft = "110px";
                                    
                                });

                                closing.addEventListener("click", function(){
                                    nav.style.left = "-300px";
                                    nav.style.backgroundColor = "transparent";
                                    nav.style.transition = "1s";
                                    closing.style.opacity = "0";
                                    opening.style.opacity = "100";
                                    opening.style.marginLeft = "-100px";
                                    opening.style.position = "relative";
                                    counteuld.style.filter = "blur(0px)";
                                    opening.style.display = "inline-table";
                                    closing.style.display = "inline-table";
                                });     
                                
                                

                              } else {
                               document.body.style.backgroundColor = "202020";
                              }
                            }
                            
                            var y = window.matchMedia("(max-width: 412px)")
                            myFunction(y) // chama o listener na hora
                            y.addListener(myFunction) // seta a função em relação as mudanças






















                            var counteuld = document.getElementById("counteuld");

                            function myFunction(ipad) {
                              if (ipad.matches) { // If media query matches
                                document.body.style.backgroundColor = "202020";
                                nav.style.zIndex = "1";
                                nav.style.left = "-300px";
                                nav.style.backgroundColor = "transparent";
                                closing.style.opacity = "0";
                                opening.style.position = "relative";
                                opening.style.opacity = "100";
                                opening.style.marginRight = "-250px";
                                opening.style.bottom = "40px";
                                closing.style.display = "none";    
                                                      

                                opening.addEventListener("click", function(){
                                    nav.style.left = "-0px";
                                    nav.style.backgroundColor = "2b2b2b";
                                    nav.style.transition = "1s";
                                    closing.style.opacity = "100";
                                    closing.style.position = "relative";
                                    counteuld.style.filter = "blur(1px)";
                                    closing.style.display = "flex";
                                    closing.style.marginLeft = "110px";
                                    
                                });

                                closing.addEventListener("click", function(){
                                    nav.style.left = "-300px";
                                    nav.style.backgroundColor = "transparent";
                                    nav.style.transition = "1s";
                                    closing.style.opacity = "0";
                                    opening.style.opacity = "100";
                                    opening.style.marginLeft = "-100px";
                                    opening.style.position = "relative";
                                    counteuld.style.filter = "blur(0px)";
                                    opening.style.display = "inline-table";
                                    closing.style.display = "inline-table";
                                });     
                                
                                

                              } else {
                               document.body.style.backgroundColor = "202020";
                              }
                            }
                            
                            var ipad = window.matchMedia("(max-width: 820px)")
                            myFunction(ipad) // chama o listener na hora
                            ipad.addListener(myFunction) // seta a função em relação as mudanças



























                            var counteuld = document.getElementById("counteuld");

                            function myFunction(c) {
                              if (c.matches) { // If media query matches
                                document.body.style.backgroundColor = "202020";
                                nav.style.zIndex = "1";
                                nav.style.left = "-300px";
                                nav.style.backgroundColor = "transparent";
                                closing.style.opacity = "0";
                                opening.style.position = "relative";
                                opening.style.opacity = "100";
                                opening.style.marginRight = "-220px";
                                opening.style.bottom = "40px";
                                closing.style.display = "none";                            

                                opening.addEventListener("click", function(){
                                    nav.style.left = "-0px";
                                    nav.style.backgroundColor = "2b2b2b";
                                    nav.style.transition = "1s";
                                    closing.style.opacity = "100";
                                    closing.style.position = "relative";
                                    counteuld.style.filter = "blur(1px)";
                                    closing.style.display = "flex";
                                    closing.style.marginLeft = "110px";
                                });

                                closing.addEventListener("click", function(){
                                    nav.style.left = "-300px";
                                    nav.style.backgroundColor = "transparent";
                                    nav.style.transition = "1s";
                                    closing.style.opacity = "0";
                                    opening.style.opacity = "100";
                                    opening.style.marginRight = "-150px";
                                    opening.style.position = "relative";
                                    counteuld.style.filter = "blur(0px)";
                                    opening.style.display = "inline-table";
                                closing.style.display = "inline-table";
                                });                               

                              } else {
                               document.body.style.backgroundColor = "202020";
                              }
                            }
                            
                            var c = window.matchMedia("(max-width: 912px)")
                            myFunction(c) // chama o listener na hora
                            c.addListener(myFunction) // seta a função em relação as mudanças










                            </script>












                        <script src="menu.js"></script>
                        <script type="module">
                            var user_final = localStorage.getItem('valueText');
        
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.8/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.6.8/firebase-analytics.js";

        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries
    
        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
        apiKey: "AIzaSyCd8BHepAbgzsZF0Ig8NRgsnTPRKvYkO4g",
        authDomain: "vexv1-adc55.firebaseapp.com",
        databaseURL: "https://vexv1-adc55-default-rtdb.firebaseio.com",
        projectId: "vexv1-adc55",
        storageBucket: "vexv1-adc55.appspot.com",
        messagingSenderId: "827882444760",
        appId: "1:827882444760:web:3b65498f6fe2161d1244ad",
        measurementId: "G-FBJX3WSQDX"
        };

        const firebaseApp = initializeApp(firebaseConfig);
    
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        import{getDatabase, ref, get, set, child, update, remove, onValue}
        from "https://www.gstatic.com/firebasejs/9.6.8/firebase-database.js";

        const db = getDatabase();

        

//------------------------------DECLARANDO VÁRIAVEIS GLOBAIS------------------------------//





function autenticar(){
            const dbref = ref(db);
get(child(dbref,"users/"+user_final)).then((snapshot)=>{

                var nome = snapshot.val().fullname;
                var senha = snapshot.val().password;
                if ((localStorage.getItem('nome') == nome) && (localStorage.getItem('senha') == senha))
                {   
                }
                else
                {

                    window.location.href = 'index.html';
                } 
                
                
        }).catch((error)=>{
            window.location.href = 'index.html';
        });
        }
        window.onload = autenticar;
        

//------------------------------DECLARANDO VÁRIAVEIS GLOBAIS------------------------------//
var btn_adicionar = document.getElementById("adicionar");

function mesAnterior(){
    var mes = parseInt(document.getElementById('guardaOmes').textContent);
    mes = mes-1;
    mes = parseInt(mes);
    if(mes<1){ mes = 12}
    document.getElementById('guardaOmes').textContent = mes;
    GetAllDataRT();
    GetGanho();
    GetDespesa();
    GetBalanco();

    datas(mes);
}
function mesPosterior(){
    var mes = parseInt(document.getElementById('guardaOmes').textContent);
    mes = mes+1;
    mes = parseInt(mes);
    if(mes>12){ mes = 1}
    document.getElementById('guardaOmes').textContent = mes;
    GetAllDataRT();
    GetGanho();
    GetDespesa();
    GetBalanco();
    datas(mes);
}



function datas(mes){

   
    if(mes == undefined){
    var data = new Date()
var mes = String(data.getMonth() + 1);
document.getElementById('guardaOmes').textContent = `${mes}`;
}
mes = document.getElementById('guardaOmes').textContent
switch(mes){
    case '1':
        nomeMes = "jan";
        document.getElementById('mes').textContent = "Janeiro de 2022";
  

    return nomeMes;

    break;
    case '2':
    nomeMes = "fev"; 
    document.getElementById('mes').textContent = "Fevereiro de 2022";

    return nomeMes;

    break;
    case '3':
    nomeMes = "mar"; 
    document.getElementById('mes').textContent = "Março de 2022";

        return nomeMes;
    break;
    case '4':
    nomeMes = "abril"; 
    document.getElementById('mes').textContent = "Abril de 2022";

        return nomeMes;
    break;
    case '5':
    nomeMes = "maio"; 
    document.getElementById('mes').textContent = "Maio de 2022";

        return nomeMes;
    break;
    case '6':
    nomeMes = "jun"; 
    document.getElementById('mes').textContent = "Junho de 2022";

        
    return nomeMes;
    break;
    case '7':
    nomeMes = "jul"; 
    document.getElementById('mes').textContent = "Julho de 2022";

       
    return nomeMes;
    break;
    case '8':
    nomeMes = "ago"; 
    document.getElementById('mes').textContent = "Agosto de 2022";

 
    return nomeMes;
    break;

        case '9':
    nomeMes = "set"; 
    document.getElementById('mes').textContent = "Setembro de 2022";


    return nomeMes;
    break;

        case '10':
    nomeMes = "out"; 
    document.getElementById('mes').textContent = "Outubro de 2022";

    
    return nomeMes;
    break;

        case '11':
    nomeMes = "nov"; 
    document.getElementById('mes').textContent = "Novembro de 2022";

    
    return nomeMes;
    break;

        case '12':
    nomeMes = "dez"; 
    document.getElementById('mes').textContent = "Dezembro de 2022";

        return nomeMes;
    break;
    
}
}

//---------------------------------CÁLCULOS---------------------------------//

function GetGanho(){
    var num = document.getElementById('guardaOmes').textContent;
    var nomeMes = datas(num);
    const dbRef = ref(db, "users/"+user_final+"/"+nomeMes+"/ganhoMensal/");
    onValue(dbRef,(snapshot)=>{    
        var ganhos = [];
    snapshot.forEach(childSnapshot =>{
    ganhos.push(childSnapshot.val());
    document.getElementById('ganhoInicial').textContent = `R$ ${ganhos}`;      
 
    });
    });
   
}

function GetBalanco(){
    var num = document.getElementById('guardaOmes').textContent;
    var nomeMes = datas(num);
const dbRef = ref(db, "users/"+user_final+"/"+nomeMes+"/balancoMensal/");

    onValue(dbRef,(snapshot)=>{    
        var balanco = [];
        snapshot.forEach(childSnapshot =>{
            balanco.push(childSnapshot.val());
    document.getElementById('balanco').textContent = `R$ ${balanco}`;  
    if (balanco >= 0){
        document.getElementById('balanco').style.color = '#0AE90A';
    }else{
        document.getElementById('balanco').style.color = 'red';
    }
 
    });
 
    });
}

function GetDespesa(){
    var num = document.getElementById('guardaOmes').textContent;
    var nomeMes = datas(num);
const dbRef = ref(db, "users/"+user_final+"/"+nomeMes+"/despesaMensal/");

    onValue(dbRef,(snapshot)=>{    
        var despesas = [];
    snapshot.forEach(childSnapshot =>{
    despesas.push(childSnapshot.val());
    document.getElementById('despesaInicial').textContent = `R$ ${despesas}`;        
    });
 
    });
}


var nomeMes = datas();




//---------------------------CRIAR DADOS---------------------------\\
const createClient = (client) => {


    var nome = document.getElementById('titulo').value;
    var tipo = document.getElementById('categoria').value;
    var valor = document.getElementById('valor').value;
    var periodo = document.getElementById('periodo').value;
    valor = parseFloat(valor).toFixed(2);


    var num = document.getElementById('guardaOmes').textContent;
    
    
    var data = new Date();
    var segundos = data.getSeconds();
    var minutos = data.getMinutes();
    var horas = data.getHours();
    var dias =  data.getDate();
    var meses = data.getMonth()+1;
    var anos = String(data.getFullYear());
    var id = anos+meses+dias+horas+minutos+segundos;


   if((nome=="") || (tipo=="") || (valor=="") ||(periodo=="")){
     alert('preencha todos os campos');
   }
   else
   {

    localStorage.setItem('db_client', client);
    var nomeMes = datas(num);
    if (periodo == "Mensal") {
        set(ref(db, "users/"+user_final+"/"+nomeMes+"/"+"metas/"+id),
            {
                id: id,
                titulo: nome,
                tipo: tipo,
                valor: valor,
                periodo: periodo,
                mes_inicial: num

            }
            )
            .then(()=>{

              document.getElementById('titulo').value = "";
              document.getElementById('categoria').value = "";
              document.getElementById('valor').value = "";
              document.getElementById('periodo').value = "";
            
            })
            .catch((error)=>{

            })
        }
    
    else if (periodo == "Bimestral") {
    
    
        set(ref(db, "users/"+user_final+"/"+nomeMes+"/"+"metas/"+id),
            {
                id: id,
                titulo: nome,
                tipo: tipo,
                valor: valor,
                periodo: periodo,
                mes_inicial: num,
                mes_final: num+1

            }
            )
            .then(()=>{

              document.getElementById('titulo').value = "";
              document.getElementById('categoria').value = "";
              document.getElementById('valor').value = "";
              document.getElementById('periodo').value = "";
            
            })
            .catch((error)=>{

            })
        
        
            num = parseFloat(num) +1;
            document.getElementById('guardaOmes').textContent = num;
            nomeMes = datas(num)
        
            set(ref(db, "users/"+user_final+"/"+nomeMes+"/"+"metas/"+id),
            {
                id: id,
                titulo: nome,
                tipo: tipo,
                valor: valor,
                periodo: periodo,
                mes_inicial: num,
                mes_final: num+1

            }
            )
            .then(()=>{

              document.getElementById('titulo').value = "";
              document.getElementById('categoria').value = "";
              document.getElementById('valor').value = "";
              document.getElementById('periodo').value = "";
              num = parseFloat(num) - 1;
              document.getElementById('guardaOmes').textContent = num;
              nomeMes = datas(num)
            
            })
            .catch((error)=>{

            })
        }else if (periodo == "Trimestral") {
            set(ref(db, "users/"+user_final+"/"+nomeMes+"/"+"metas/"+id),
            {
                id: id,
                titulo: nome,
                tipo: tipo,
                valor: valor,
                periodo: periodo,
                mes_inicial: num,
                mes_final: num+2

            }
            )
            .then(()=>{

              document.getElementById('titulo').value = "";
              document.getElementById('categoria').value = "";
              document.getElementById('valor').value = "";
              document.getElementById('periodo').value = "";
            
            })
            .catch((error)=>{

            })
        
            set(ref(db, "users/"+user_final+"/"+nomeMes+"/"+"metas/"+id),
            {
                id: id,
                titulo: nome,
                tipo: tipo,
                valor: valor,
                periodo: periodo,
                mes_inicial: num,
                mes_final: num+2

            }
            )
            .then(()=>{

              document.getElementById('titulo').value = "";
              document.getElementById('categoria').value = "";
              document.getElementById('valor').value = "";
              document.getElementById('periodo').value = "";
            
            })
            .catch((error)=>{

            })
            nomeMes = datas(num+1);
            set(ref(db, "users/"+user_final+"/"+nomeMes+"/"+"metas/"+id),
            {
                id: id,
                titulo: nome,
                tipo: tipo,
                valor: valor,
                periodo: periodo,
                mes_inicial: num,
                mes_final: num+2

            }
            )
            .then(()=>{

              document.getElementById('titulo').value = "";
              document.getElementById('categoria').value = "";
              document.getElementById('valor').value = "";
              document.getElementById('periodo').value = "";
            
            })
            .catch((error)=>{

            })
        }
    }
}




//---------------------------LER E MOSTRAR DADOS---------------------------\\
var valores = [];      
var tbody = document.getElementById('tbody');

//-------------------RECEBENDO TODO O SNAPCHOT DO DB-------------------\\

function GetAllDataRT(){

    var num = document.getElementById('guardaOmes').textContent;
    var nomeMes = datas(num);

const dbRef = ref(db,"users/"+user_final+"/"+nomeMes+"/metas/");

    onValue(dbRef,(snapshot)=>{
    var metas = [];
    snapshot.forEach(childSnapshot =>{
    metas.push(childSnapshot.val());
    });
    AddAll(metas);
    });
            }

GetAllDataRT();
//-------------------RECEBENDO DADOS DO SNAPCHOT-------------------\\

function AddAll(users){

tbody.innerHTML="";
users.forEach(element => {
    AddItemTb(element.titulo, element.tipo, element.periodo, element.valor, element.id);

});

}

//-------------------CRIANDO LINHAS DA TABELA-------------------\\
function AddItemTb(titulo, tipo, periodo, valor, id){
    
let trow = document.createElement('tr');

let td1 = document.createElement('td');

let td2 = document.createElement('td');

let td4 = document.createElement('td');

let td5 = document.createElement('td');

let td6 = document.createElement('td');

valores.push([titulo, tipo, periodo, valor, id]);
td1.innerHTML=titulo; 
td2.innerHTML=tipo; 
td4.innerHTML=periodo;
td5.innerHTML= 'R$ '+valor;

trow.appendChild(td1);
trow.classList.add("sc-gKseQn");
//
td1.classList.add("sc-iBPTik"); 
td1.classList.add("gZUaaB"); 
td1.classList.add("alignTitulo");
trow.appendChild(td2);
//
td2.classList.add("sc-fubCzh");

if (tipo == "Alimentação")
{
td2.classList.add("alimentacao");
}else if(tipo == "Entretenimento"){
    td2.classList.add("entretenimento");
}else if(tipo == "Habitação"){
    td2.classList.add("habitacao");
}else if(tipo == "Salário"){
    td2.classList.add("salario");
}
else if(tipo == "Saúde"){
    td2.classList.add("saude");
}else if(tipo == "Seguros"){
    td2.classList.add("seguros");
}
else if(tipo == "Transportes"){
    td2.classList.add("transportes");
}else if(tipo == "Outros"){
    td2.classList.add("outros");
}

td2.classList.add("alignCategoria");

trow.appendChild(td4);
//
td4.classList.add("sc-iBPTik"); 
td4.classList.add("gZUaaB"); 
td4.classList.add("alignData");
trow.appendChild(td5);  
//
td5.classList.add("sc-pGacB"); 
td5.classList.add("fZFMZi"); 
td5.classList.add("alignValor");
  
var Controle = document.createElement("div");
var Editar = document.createElement("div");


td6.innerHTML = '<div class="butao_teste alignAcoes"><button type="button" class="butao" onclick="pegaId('+id+')" ><img src="img/outline_delete_white_24dp.png"></button><button type="button" class="butao" id = "'+id+'"  onclick="pegaIdEditar(id)"><img src="img/outline_edit_white_24dp.png"></button></div>'
//Controle.innerHTML = '<div class="butao_teste alignAcoes"><button type="button" class="butao" id = "'+id+'" onclick="pegaId(id)" ><img src="img/outline_delete_white_24dp.png"></button></div>'
//Editar.innerHTML = '<div class="butao_teste alignAcoes"><button type="button" class="butao" id = "'+id+'"  onclick="pegaIdEditar(id);" ><img src="img/outline_edit_white_24dp.png"></button></div>'

trow.appendChild(td6);
    
tbody.appendChild(trow);

document.getElementById(id).addEventListener('click',selectData);

GetGanho();
GetDespesa();
GetBalanco();

}

//---------------------------EXLUIR DADOS---------------------------\\
function deleteData(){

    var num = String(document.getElementById('teste').value).trim();
    var num1 = document.getElementById('guardaOmes').textContent;
    var nomeMes = datas(num1);
    const dbRef = ref(db);
    get(child(dbRef,"users/"+user_final+"/"+nomeMes+"/metas/"+num)).then((snapshot)=>{
        if(snapshot.exists()){

         var periodo = snapshot.val().periodo;
        if(periodo == "Mensal"){
            remove(ref(db,"users/"+user_final+"/"+nomeMes+"/metas/"+num),{
            })
            .then(()=>{
                
                closemodalDeletar();
            })
          
        }
        if(periodo == "Bimestral"){
            remove(ref(db,"users/"+user_final+"/"+nomeMes+"/metas/"+num),{
            })
            .then(()=>{
                
                closemodalDeletar();
            })
          
                num1 = parseFloat(num1) + 1;
                document.getElementById('guardaOmes').textContent = num1;
                var nomeMes1 = datas(num1);
                get(child(dbRef,"users/"+user_final+"/"+nomeMes1+"/metas/"+num)).then((snapshot)=>{

                    if(snapshot.exists()){

                        remove(ref(db,"users/"+user_final+"/"+nomeMes1+"/metas/"+num),{  
                })
                num1 = parseFloat(num1) - 1;
              document.getElementById('guardaOmes').textContent = num1;
              nomeMes1 = datas(num1)
                    } else{
                        num1 = parseFloat(num1) - 2;
                        document.getElementById('guardaOmes').textContent = num1;
                        nomeMes1 = datas(num1);
                        remove(ref(db,"users/"+user_final+"/"+nomeMes1+"/metas/"+num),{  
                })
                num1 = parseFloat(num1) + 1;
              document.getElementById('guardaOmes').textContent = num1;
              nomeMes1 = datas(num1)
                    }


                });
              
        }
            }
                });
            
}


//função do update
function alterData(){
    const dbRef = ref(db);
    var mes = document.getElementById('guardaOmes').textContent;
    var nomeMes = datas(mes);
    var nome = document.getElementById('titulo').value;
    var tipo = document.getElementById('categoria').value;
    var valor = document.getElementById('valor').value;
    valor = parseFloat(valor).toFixed(2);
    var periodo = document.getElementById('periodo').value;
    var num = String(document.getElementById('idEditar').value).trim();

    if (document.getElementById('periodo').value == "Mensal")
            {            

                update(ref(db,"users/"+user_final+"/"+nomeMes+"/metas/"+num),{
                titulo: nome,
                tipo: tipo,
                valor: valor,
                periodo: periodo
            })
            .then(()=>{


                document.getElementById('titulo').value = "";
                document.getElementById('categoria').value = "";
                document.getElementById('valor').value = "";
                document.getElementById('periodo').value = "";
                document.getElementById('periodo').style.pointerEvents = "auto";
                document.querySelector('#editar').classList.add('sumiu');
                document.querySelector('#adicionar').classList.remove('sumiu');
                

              

           })
           .catch((error)=>{
                
           });
        }
    else if (document.getElementById('periodo').value == "Bimestral") {
        update(ref(db,"users/"+user_final+"/"+nomeMes+"/metas/"+num),{
                titulo: nome,
                tipo: tipo,
                valor: valor,
                periodo: periodo
    }).then(()=>{
            mes= parseFloat(mes) + 1;
            document.getElementById('guardaOmes').textContent = mes;
            nomeMes = datas(mes);
            get(child(dbRef,"users/"+user_final+"/"+nomeMes+"/metas/"+num)).then((snapshot)=>{
                if(snapshot.exists()){
                    update(ref(db,"users/"+user_final+"/"+nomeMes+"/metas/"+num),{
                            titulo: nome,
                            tipo: tipo,
                            valor: valor,
                            periodo: periodo
            });   
            mes = parseFloat(mes) - 1;
              document.getElementById('guardaOmes').textContent = mes;
              nomeMes = datas(mes);

                }
                else{
                    mes = parseFloat(mes) - 2;
                    document.getElementById('guardaOmes').textContent = mes;
                        nomeMes = datas(mes);
                        update(ref(db,"users/"+user_final+"/"+nomeMes+"/metas/"+num),{
                            titulo: nome,
                            tipo: tipo,
                            valor: valor,
                            periodo: periodo
                    });
                    mes = parseFloat(mes) + 1;
              document.getElementById('guardaOmes').textContent = mes;
              nomeMes = datas(mes);
                    
                }
            });
    });
                document.getElementById('titulo').value = "";
                document.getElementById('categoria').value = "";
                document.getElementById('valor').value = "";
                document.getElementById('periodo').style.pointerEvents = "auto";
                document.getElementById('periodo').value = "";
                document.querySelector('#editar').classList.add('sumiu');
                document.querySelector('#adicionar').classList.remove('sumiu');
                datas(mes)   
    }
}

//---------------------------LER E MOSTRAR DADOS NOS MODAIS---------------------------\\

function selectData(){
    var num = document.getElementById('guardaOmes').textContent;
    var nomeMes = datas(num);
    var num = String(document.getElementById('idEditar').value).trim();

    
        const dbref = ref(db);
        get(child(dbref,"users/"+user_final+"/"+nomeMes+"/metas/"+num)).then((snapshot)=>{
            if(snapshot.exists()){
                document.getElementById('titulo').value = snapshot.val().titulo;
                document.getElementById('categoria').value = snapshot.val().tipo;
                document.getElementById('valor').value = snapshot.val().valor;
                document.getElementById('periodo').value = snapshot.val().periodo;
                
                document.getElementById('periodo').style.pointerEvents = "none";

               document.querySelector('#editar').classList.remove('sumiu');
               document.querySelector('#adicionar').classList.add('sumiu');
               
            }else{
              
            }
        })
        .catch((error)=>{
          
        });
    }
    
    



//------------------------------DECLARANDO AÇÕES DOS BOTÕES------------------------------//
  
    btn_adicionar.addEventListener('click', createClient);
    document.getElementById('excluir').addEventListener('click', deleteData);
    document.getElementById('editar').addEventListener('click', alterData);
    document.getElementById('anterior').addEventListener('click', mesAnterior);
    document.getElementById('proximo').addEventListener('click', mesPosterior);


     
    
    
</script>

<script>

   //---------------------------PEGAR ID PARA EDITAR---------------------------\\    
   function pegaIdEditar(num){

document.getElementById('IdVerdadeiro').innerHTML = `<input id="idEditar" value="${num}" hidden> </input>`;
//document.getElementById("editar").innerHTML = '<div class="sc-bkzYnD kLxSip">&nbsp;</div><button class="sc-hHfuMS dcAQVR" id="editarFinal">Editar</button>'
return num;

}

    //---------------------------PEGAR ID PARA EXCLUIR---------------------------\\

function pegaId(num){

document.getElementById('IdVerdadeiro').innerHTML = `<input id="teste" value="${num}" hidden> </input>`;
openmodalDeletar();
return num;
}

//---------------------------ABRIR MODAL DE DELETAR---------------------------\\

const openmodalDeletar = () => document.getElementById('modalDeletar').classList.add('active');

//---------------------------FECHAR MODAL DE DELETAR---------------------------\\

const closemodalDeletar = () => {document.getElementById('modalDeletar').classList.remove('active');}

//---------------------------ATRIBUINDO O CLOSEMODALDELETAR---------------------------\\
document.getElementById('modalCloseExcluir').addEventListener('click', closemodalDeletar);






var body = document.getElementById("body");

        function opacidade(){
            body.style.transition = "2s";
            body.style.opacity = "100";
        };

        setTimeout(opacidade, "700");


    var nav = document.getElementById("nav");
    var links = document.getElementById("links");
    var closing = document.getElementById("closing");
    var icon = document.getElementById("icon");
    var icontext = document.getElementById("icontext");
    var saida = document.getElementById("saida");
    var between = document.getElementById("between");
    var opening = document.getElementById("opening");
    var logoff = document.getElementById("logoff");
    var iclogout = document.getElementById("iclogout");















    closing.addEventListener("click", function(){
        nav.style.marginLeft = "-12.1%";
        nav.style.transition = "1s";
        nav.style.width = "299px";
        closing.style.left = "-5%";
        closing.style.transition = "2s";
        opening.style.opacity = "100";
        opening.style.top = "-5%";
        opening.style.left = "100px";
        opening.style.position = "relative";
        opening.style.transition = "1.5s";
        between.style.marginLeft = "-50%";
        between.style.transition = "1s";
        graphs.style.position = "relative";
        graphs.style.width = "45%";
        graphs.style.transition = "1s";
      
    });

    opening.addEventListener("click", function(){
        nav.style.marginLeft = "-0%";
        nav.style.width = "300px";
        opening.style.left = "-200px";
        opening.style.opacity = "0";
        closing.style.left = "44%";
        between.style.marginLeft = "-0%";
        between.style.transition = "1s";
    });

   
    metas.addEventListener("mouseover", function(){
        metas.style.backgroundColor = "#f5c116";
        line1.style.color = "#000";
        metas.style.transition = "0.5s";
    });

    metas.addEventListener("mouseout", function(){
        metas.style.backgroundColor = "transparent";
        line1.style.color = "#fff";
        metas.style.transition = "0.3s";
    });




    graph.addEventListener("mouseover", function(){
        graph.style.backgroundColor = "#f5c116";
        line2.style.color = "#000";
        graph.style.transition = "0.5s";
    });

    graph.addEventListener("mouseout", function(){
        graph.style.backgroundColor = "transparent";
        line2.style.color = "#fff";
        graph.style.transition = "0.3s";
    });




    control.addEventListener("mouseover", function(){
        control.style.backgroundColor = "#f5c116";
        line3.style.color = "#000";
        control.style.transition = "0.5s";
    });

    control.addEventListener("mouseout", function(){
        control.style.backgroundColor = "transparent";
        line3.style.color = "#fff";
        control.style.transition = "0.3s";
    });
   



    logoff.addEventListener("mouseover", function(){
        logoff.style.backgroundColor = "#f5c116";
        logoff.style.color = "#000";
        logoff.style.transition = "0.5s";
        iclogout.style.color = "#000";
    });

    logoff.addEventListener("mouseout", function(){
        logoff.style.backgroundColor = "transparent";
        logoff.style.color = "#fff";
        logoff.style.transition = "0.3s";
        iclogout.style.color = "#fff";
    });







    

 

    //TERMINA SCRIPT DO MENU//
    



</script>



    











</body></html>